#!/usr/bin/env bash
# ----------------------------------------------------------------------
# Numenta Platform for Intelligent Computing (NuPIC)
# Copyright (C) 2015, Numenta, Inc.  Unless you have an agreement
# with Numenta, Inc., for a separate license for this software code, the
# following terms and conditions apply:
#
# This program is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License version 3 as
# published by the Free Software Foundation.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
# See the GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see http://www.gnu.org/licenses.
#
# http://numenta.org/licenses/
# ----------------------------------------------------------------------

clean_option=''
verbose_option=''
user_option=''

print_usage () {
  echo "Installs NuPIC and nupic.core from their respective source directories."
  echo
  echo "Usage:"
  echo "> install_nupic_all [options]"
  echo
  echo "Options:"
  echo " -c Clean build, removes old build artifacts."
  echo " -v Verbose console output."
  echo " -u Runs python setup.py install with the --user option."
}

# cmd line options processing
process_options () {
  while getopts "cvnur:" optname
    do
      case "$optname" in
        "c")
          clean_option='-c'
          ;;
        "v")
          verbose_option='-v'
          ;;
        "u")
          user_option="-u"
          ;;
        "?")
          print_usage
          exit
          ;;
        ":")
          print_usage
          exit
          ;;
        *)
          # Should not occur
          print_usage
          exit
          ;;
      esac
    done
  return $OPTIND
}

process_options "$@"
argstart=$?

install_nupic_core ${clean_option} ${verbose_option} || exit
install_nupic -n ${clean_option} ${verbose_option} ${user_option}
